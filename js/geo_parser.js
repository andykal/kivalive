function exPubSub(r){var t={},n={};r.forEach(function(r){var a=r.channel;r.lat&&r.lng&&validGeolocFilter([r.lat,r.lng])&&(a in n||(n[a]=[]),n[a].push([r.lat,r.lng])),r.geos.length&&r.geos.filter(validGeolocFilter).forEach(function(r){a in t||(t[a]=[]),t[a].push(r)})});for(var a=Object.keys(t),e=[],o=0;o<a.length;o++)for(var l=a[o],u=0;u<t[l].length;u++){var i=t[l][u],f=n[l];if(i&&f&&f.length>1){var c=f;e.push({pub:i,subs:c})}}return e=_.sortBy(e,function(r){var t=0;return r.subs.forEach(function(n){t+=vecDiff(n,r.pub)}),t}),e.reverse(),e}function validGeolocFilter(r){var t=Math.abs(r[0]),n=Math.abs(r[1]);return 180>=n&&90>=t}var vecDiff=function(r,t){var n=Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2));return n};
